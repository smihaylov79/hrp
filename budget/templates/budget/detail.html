{% extends "base.html" %}
{% block content %}
<div class="container mt-4">
  <h2>–ë—é–¥–∂–µ—Ç: <b>{{ budget.name }}</b></h2>
    <h4>–ü–µ—Ä–∏–æ–¥: <b>{{ budget.date_from }} - {{ budget.date_to }}</b></h4>
<h5>–†–∞–∑—Ö–æ–¥–∏: <b>{{ total_amount }} {{ budget.currency }}</b></h5>
<h5>–ü—Ä–∏—Ö–æ–¥–∏: <b>{{ total_income }} {{ budget.currency }}</b></h5>

<h4 class="mt-4">–†–∞–∑—Ö–æ–¥–∏</h4>
<table class="table table-sm table-bordered">
  <thead>
    <tr>
      <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
      <th>–ü–ª–∞–Ω–∏—Ä–∞–Ω–∞ —Å—É–º–∞ ({{ budget.currency }})</th>
    </tr>
  </thead>
  <tbody>
    {% for item in budget.items.all %}
      <tr>
        <td>{{ item.category.name }}</td>
        <td>{{ item.planned_amount }}</td>
      </tr>
    {% empty %}
      <tr>
        <td colspan="2" class="text-center text-muted">–ù—è–º–∞ –≤—ä–≤–µ–¥–µ–Ω–∏ —Ä–∞–∑—Ö–æ–¥–∏</td>
      </tr>
    {% endfor %}
  </tbody>
</table>


<h4 class="mt-4">–ü—Ä–∏—Ö–æ–¥–∏</h4>
<table class="table table-sm table-bordered">
  <thead>
    <tr>
      <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
      <th>–ü–ª–∞–Ω–∏—Ä–∞–Ω–∞ —Å—É–º–∞ ({{ budget.currency }})</th>
    </tr>
  </thead>
  <tbody>
    {% for inc in budget.income_items.all %}
      <tr>
        <td>{{ inc.income_type.name }}</td>
        <td>{{ inc.planned_amount }}</td>
      </tr>
    {% empty %}
      <tr>
        <td colspan="2" class="text-center text-muted">–ù—è–º–∞ –≤—ä–≤–µ–¥–µ–Ω–∏ –ø—Ä–∏—Ö–æ–¥–∏</td>
      </tr>
    {% endfor %}
  </tbody>
</table>


<h4>–û–¥–æ–±—Ä–µ–Ω–∏—è</h4>
<ul>
  {% for approval in approvals %}
    <li>{{ approval.user.first_name }} ‚Äì
        {% if approval.approved %}
          ‚úÖ –û–¥–æ–±—Ä–µ–Ω–æ
        {% else %}
          ‚è≥ –û—á–∞–∫–≤–∞ —Å–µ
        {% endif %}
    </li>
  {% endfor %}
</ul>

<div class="d-flex justify-content-center gap-3 mt-4">

  {% if user_approval and not user_approval.approved %}
  <form method="post" class="m-0">
    {% csrf_token %}
    <button type="submit" name="action" value="approve" class="btn btn-success px-4">
      ‚úî –û–¥–æ–±—Ä–∏ –±—é–¥–∂–µ—Ç–∞
    </button>
  </form>
  {% endif %}

  <a href="{% url 'edit_budget' budget.id %}" class="btn btn-warning px-4">
    ‚úèÔ∏è –ü—Ä–æ–º–µ–Ω–∏ –±—é–¥–∂–µ—Ç–∞
  </a>

  <a href="{% url 'budget_home' %}" class="btn btn-secondary px-4">
    üìÅ –í—Å–∏—á–∫–∏ –±—é–¥–∂–µ—Ç–∏
  </a>

</div>


</div>
{% endblock %}
