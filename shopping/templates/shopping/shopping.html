{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
  <h2 class="mb-4 text-center">üõí –í—Å–∏—á–∫–∏ –ø–æ–∫—É–ø–∫–∏</h2>
<div class="d-flex justify-content-between align-items-center mb-3">
<div class="text-end mb-3">
    <a href="{% url 'utility_bills' %}" class="btn btn-outline-success">
      ‚ûï –ü–ª–∞—Ç–∏ –±–∏—Ç–æ–≤–∏ —Å–º–µ—Ç–∫–∏
    </a>
</div>
  <!-- ‚ûï Create New Shopping Button -->

  <div class="text-end mb-3">
    <a href="{% url 'regular_shopping' %}" class="btn btn-outline-success">
      ‚ûï –†–µ–≥–∏—Å—Ç—Ä–∏—Ä–∞–π –Ω–æ–≤–∞ –ø–æ–∫—É–ø–∫–∞
    </a>
  </div>
</div>

<form method="get" class="mb-3 d-flex gap-2">
  <select name="product_id" class="form-select" onchange="this.form.submit()">
    <option value="">üîç –ü–æ–∫—É–ø–∫–∏ —Å –≤—Å–∏—á–∫–∏ –ø—Ä–æ–¥—É–∫—Ç–∏</option>
    {% for product in products %}
      <option value="{{ product.id }}" {% if product.id|stringformat:"s" == selected_product_id %}selected{% endif %}>
  {{ product.name }}
</option>
    {% endfor %}
  </select>
  {% if selected_product_id %}
    <a href="{% url 'shopping' %}" class="btn btn-sm btn-outline-secondary">‚ùå –ü—Ä–µ–º–∞—Ö–Ω–∏ —Ñ–∏–ª—Ç—ä—Ä–∞</a>
  {% endif %}
</form>

<div class="table-responsive" style="max-height: 600px; overflow-y: auto;">
  <table class="table table-bordered table-striped align-middle">
    <thead class="table-light">
      <tr>
        <th>–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª</th>
        <th>–î–∞—Ç–∞</th>
        <th>–ú–∞–≥–∞–∑–∏–Ω</th>
        <th>–û–±—â–æ</th>
        <th>–í–∞–ª—É—Ç–∞</th>
        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
      </tr>
    </thead>
    <tbody>
      {% for shopping in shoppings %}
      <tr>
        <td>{{ shopping.user.first_name }}</td>
        <td>{{ shopping.date }}</td>
        <td>{{ shopping.shop.name }}</td>
        <td>{{ shopping.total_amount }}</td>
        <td>{{ shopping.currency }}</td>
        <td>
          <a href="{% url 'edit_shopping' shopping.id %}?product_id={{ selected_product_id }}" class="btn btn-sm btn-outline-primary">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–∞–π</a>
        </td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="5" class="text-center text-muted">–ù—è–º–∞ –ø–æ–∫—É–ø–∫–∏ –∫—ä–º –º–æ–º–µ–Ω—Ç–∞.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

</div>
{% endblock %}
