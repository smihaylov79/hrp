{% extends "base.html" %}

{% block content %}
<div class="container my-4">
  <h2 class="mb-4">üõí –†–µ–¥–∞–∫—Ç–∏—Ä–∞–Ω–µ –Ω–∞ –ø–æ–∫—É–ø–∫–∞</h2>

  <form method="POST">
    {% csrf_token %}

    <div class="row mb-3">
      <div class="col-md-6">
        <label for="date" class="form-label">üìÖ –î–∞—Ç–∞ –Ω–∞ –ø–æ–∫—É–ø–∫–∞:</label>
        <input type="date" name="date" class="form-control" value="{{ shopping.date|date:'Y-m-d' }}" required>
      </div>
      <div class="col-md-6">
        <label for="shop_id" class="form-label">üè¨ –ò–∑–±–µ—Ä–∏ –º–∞–≥–∞–∑–∏–Ω:</label>
        <select name="shop_id" class="form-select">
          {% for shop in shops %}
            <option value="{{ shop.id }}" {% if shop.id == shopping.shop.id %}selected{% endif %}>{{ shop.name }}</option>
          {% endfor %}
        </select>
      </div>
    </div>

    <h4 class="mb-3">üì¶ –ü—Ä–æ–¥—É–∫—Ç–∏ –≤ –ø–æ–∫—É–ø–∫–∞—Ç–∞</h4>
    <div class="table-responsive">
      <table class="table table-bordered align-middle">
        <thead class="table-light">
          <tr>
            <th>–ü—Ä–æ–¥—É–∫—Ç</th>
            <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
            <th>–¶–µ–Ω–∞</th>
            <th>–û—Ç—Å—Ç—ä–ø–∫–∞</th>
              <th>–°—É–º–∞</th>
            <th>–î–µ–π—Å—Ç–≤–∏–µ</th>
          </tr>
        </thead>
        <tbody>
          {% for item in shopping.shopping_products.all %}
            <tr>
              <td>{{ item.product.name }}</td>
              <td>
                <input type="number" step="0.001" name="quantity_{{ item.id }}" class="form-control form-control-sm" value="{{ item.quantity }}" required>
              </td>
              <td>
                <input type="number" step="0.01" name="price_{{ item.id }}" class="form-control form-control-sm" value="{{ item.price }}" required>
              </td>
              <td>
                <input type="number" step="0.01" name="discount_{{ item.id }}" class="form-control form-control-sm" value="{{ item.discount }}" required>
              </td>
                <td>
                <input type="number" step="0.01" name="amount_{{ item.id }}" class="form-control form-control-sm" value="{{ item.amount }}" readonly>
              </td>
              <td>
                <button type="submit" name="delete_product" value="{{ item.id }}" class="btn btn-sm btn-danger">
                  ‚ùå –ü—Ä–µ–º–∞—Ö–Ω–∏
                </button>
              </td>
            </tr>
          {% endfor %}
        </tbody>
      <tfoot>
      <tr class="table-secondary">
        <td colspan="4" class="text-end fw-bold">–û–±—â–æ:</td>
        <td class="fw-bold text-success">{{ shopping.total_amount|floatformat:2 }} –ª–≤</td>
      </tr>
    </tfoot>
      </table>
    </div>


    <div class="d-flex justify-content-between mt-4">
      <button type="submit" class="btn btn-success">üíæ –ó–∞–ø–∞–∑–∏ –ø—Ä–æ–º–µ–Ω–∏—Ç–µ</button>
      <a href="{% url 'shopping' %}" class="btn btn-secondary">‚õî –û—Ç–∫–∞–∑</a>
    </div>
  </form>
</div>


{% endblock %}
