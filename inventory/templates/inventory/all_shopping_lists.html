{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="container mt-4">
    <h2 class="mb-4">üõçÔ∏è –°–ø–∏—Å—ä—Ü–∏ –∑–∞ –ø–∞–∑–∞—Ä—É–≤–∞–Ω–µ</h2>

    <button onclick="toggleFilter()" class="btn btn-outline-warning mb-3" id="filter-toggle-btn">
        üö´ –ü–æ–∫–∞–∂–∏ –Ω–µ–∏–∑–ø—ä–ª–Ω–µ–Ω–∏
    </button>

    <div class="table-scroll-wrapper table-responsive" style="max-height: 500px; overflow-y: auto;">
        <table class="table table-bordered table-striped align-middle">
            <thead class="table-light">
                <tr>
                    <th>–î–∞—Ç–∞ / –†–µ—Ü–µ–ø—Ç–∞</th>
                    <th>–°—Ç–∞—Ç—É—Å</th>
                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                </tr>
            </thead>
            <tbody id="shopping-list-table">
                {% for shopping_list in shopping_lists %}
                <tr class="list-row {% if shopping_list.executed %}executed{% else %}unexecuted{% endif %}">
                    <td>{{ shopping_list.date_generated }}</td>
                    <td>{% if shopping_list.executed %}‚úÖ –ò–∑–ø—ä–ª–Ω–µ–Ω{% else %}‚ùå –ù–µ–∏–∑–ø—ä–ª–Ω–µ–Ω{% endif %}</td>
                    <td>
                        <a href="{% url 'shopping_list_view' shopping_list.id %}" class="btn btn-sm btn-outline-info">üîç –ü—Ä–µ–≥–ª–µ–¥</a>
                        {% if not shopping_list.executed %}
                        <a href="{% url 'execute_shopping_list' shopping_list.id %}" class="btn btn-sm btn-outline-success">‚úÖ –ò–∑–ø—ä–ª–Ω–∏</a>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
                {% for recipe_list in recipe_shopping_lists %}
                <tr class="list-row {% if recipe_list.executed %}executed{% else %}unexecuted{% endif %}">
                    <td>{{ recipe_list.recipe_name }}</td>
                    <td>{% if recipe_list.executed %}‚úÖ –ò–∑–ø—ä–ª–Ω–µ–Ω{% else %}‚ùå –ù–µ–∏–∑–ø—ä–ª–Ω–µ–Ω{% endif %}</td>
                    <td>
                        <a href="{% url 'recipe_shopping_list_view' recipe_list.id %}" class="btn btn-sm btn-outline-info">üîç –ü—Ä–µ–≥–ª–µ–¥</a>
                        {% if not recipe_list.executed %}
                        <a href="{% url 'execute_recipe_shopping_list' recipe_list.id %}" class="btn btn-sm btn-outline-success">‚úÖ –ò–∑–ø—ä–ª–Ω–∏</a>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="text-center">
        <a href="{% url 'inventory' %}" class="btn btn-outline-secondary mt-4">üîô –û–±—Ä–∞—Ç–Ω–æ –∫—ä–º –Ω–∞–ª–∏—á–Ω–æ—Å—Ç–∏</a>
    </div>


    <script>
        function toggleFilter() {
            const rows = document.querySelectorAll(".list-row");
            const button = document.getElementById("filter-toggle-btn");
            const showAll = button.textContent.includes("üîÅ");

            rows.forEach(row => {
                if (row.classList.contains("executed")) {
                    row.style.display = showAll ? "table-row" : "none";
                }
            });

            button.textContent = showAll ? "üö´ –ü–æ–∫–∞–∂–∏ –Ω–µ–∏–∑–ø—ä–ª–Ω–µ–Ω–∏" : "üîÅ –ü–æ–∫–∞–∂–∏ –≤—Å–∏—á–∫–∏ —Å–ø–∏—Å—ä—Ü–∏";
        }
    </script>
</div>
{% endblock %}
