{% extends "base.html" %}

{% block content %}
    <h2>Отчет на разходите</h2>
    <form method="GET" action="{% url 'inventory_reports' %}">
        <label for="category">Filter by Category:</label>
        <select name="category">
            <option value="">All Categories</option>
            {% for category in user_categories %}
                <option value="{{ category.product_category.id }}">{{ category.product_category.name }}</option>
            {% endfor %}
        </select>

        <label for="date">Filter by Date:</label>
        <input type="date" name="date">

        <label for="shop">Filter by Shop:</label>
        <select name="shop">
            <option value="">All Shops</option>
            {% for shop in user_shops %}
                <option value="{{ shop.id }}">{{ shop.name }}</option>
            {% endfor %}
        </select>

        <button type="submit">Apply Filters</button>
    </form>

    <h3>Total Spent: {{ total_spent }} лв.</h3>

    <h3>Price Tracking</h3>
    <table>
        <tr>
            <th>Product</th>
            <th>Average Price</th>
        </tr>
        {% for item in avg_price_changes %}
        <tr>
            <td>{{ item.product__name }}</td>
            <td>{{ item.avg_price }} лв.</td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="2">No price changes recorded.</td>
        </tr>
        {% endfor %}
    </table>
{% endblock %}
