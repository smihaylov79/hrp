{% extends "base.html" %}
{% load i18n %}
{% block content %}

    {% if weather_error %}
        <div class="alert alert-warning mt-3">
            ‚ö†Ô∏è {{ weather_error }}
        </div>
    {% endif %}

    {% if weather_data %}
        <div class="container mt-3">

            <div class="card shadow-sm">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center flex-wrap">
                        <div>
                            <form method="get" action="{% url 'set_location' %}" class="d-flex align-items-center mb-2"
                                  style="max-width: 300px;">
                                <input type="text" name="location" class="form-control form-control-sm me-2"
                                       placeholder="{% trans '–í—ä–≤–µ–¥–∏ –≥—Ä–∞–¥...' %}" required>
                                <button type="submit" class="btn btn-outline-primary btn-sm">
                                    {% trans "–ü—Ä–æ–º–µ–Ω–∏" %}
                                </button>
                            </form>

                            <h6 class="card-title mb-1">
                                {{ now|date:"d M, H:i" }} ‚Äì {{ weather_data.location.name }}
                                ({{ weather_data.location.region }})
                            </h6>

                            <p class="mb-0">
                                üå°Ô∏è {{ weather_data.current.temp_c }}¬∞C,
                                {{ weather_data.current.condition.text }}
                                <img src="{{ weather_data.current.condition.icon }}" alt="{% trans 'Weather icon' %}">
                                <div class="mb-0">
                                    {{ rate.base_currency }} / {{ rate.target_currency }}: {{ rate.rate }}
                                </div>
                            </p>
                        </div>

                        <div class="d-flex gap-3 flex-wrap">
                            {% for day in weather_data.forecast.forecastday|slice:":3" %}
                                <div class="text-center">
                                    <a href="{% url 'detailed-forecast' day.parsed_date|date:'Y-m-d' %}"
                                       class="text-decoration-none text-dark">
                                        <strong>{{ day.parsed_date|date:"d M" }}</strong><br>
                                        <small>
                                            {% trans "min" %} {{ day.day.mintemp_c }}¬∞C<br>
                                            {% trans "max" %} {{ day.day.maxtemp_c }}¬∞C
                                        </small><br>
                                        {{ day.day.condition.text }}<br>
                                        <img src="{{ day.day.condition.icon }}" alt="{% trans 'Icon' %}"><br>
                                        üåßÔ∏è{{ day.day.daily_chance_of_rain }}%
                                    </a>
                                </div>
                            {% endfor %}
                        </div>

                    </div>
                </div>
            </div>
        </div>
    {% endif %}

    {% if user.is_authenticated %}
        {% if task_total > 0 %}
            <div class="alert alert-info mt-3">

                {% if tasks_today %}
                    üìù {% blocktrans %}–ò–º–∞—à {{ tasks_today }} –∑–∞–¥–∞—á–∏ –∑–∞ –¥–Ω–µ—Å{% endblocktrans %}
                {% else %}
                    ‚úÖ {% trans "–ù—è–º–∞ –∑–∞–¥–∞—á–∏ –∑–∞ –¥–Ω–µ—Å!" %}
                {% endif %}

                {% if tasks_overdue %}
                    {% blocktrans %}–∏ {{ tasks_overdue }} –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–∏!{% endblocktrans %}
                {% endif %}

                <a href="{% url 'task_list' %}" class="btn btn-sm btn-primary ms-3">
                    {% trans "–í–∏–∂ –≤—Å–∏—á–∫–∏ –∑–∞–¥–∞—á–∏" %}
                </a>
            </div>
        {% else %}
            <div class="alert alert-success mt-3">
                ‚úÖ {% trans "–ù—è–º–∞ –∑–∞–¥–∞—á–∏ –∑–∞ –¥–Ω–µ—Å!" %}
            </div>
        {% endif %}

        {% if events_today %}
            <div class="alert alert-primary mt-3">
                üìÖ {% blocktrans %}–ò–º–∞—à {{ events_today|length }} —Å—ä–±–∏—Ç–∏—è –∑–∞ –¥–Ω–µ—Å{% endblocktrans %}
                <a href="{% url 'calendar' %}" class="btn btn-sm btn-outline-primary ms-3">
                    {% trans "–í–∏–∂ –∫–∞–ª–µ–Ω–¥–∞—Ä" %}
                </a>
            </div>
        {% else %}
            <div class="alert alert-success mt-3">
                üìÖ {% trans "–ù—è–º–∞ —Å—ä–±–∏—Ç–∏—è –∑–∞ –¥–µ–Ω—è!" %}
            </div>
        {% endif %}
    {% endif %}

    <div class="container my-4">
        <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-4">

            <div class="col">
                <a href="{% url 'reports_home' %}" class="text-decoration-none">
                    <div class="card text-center shadow-sm h-100">
                        <div class="card-body">
                            <h5 class="card-title">üìä {% trans "–û—Ç—á–µ—Ç–∏ –∏ –∞–Ω–∞–ª–∏–∑–∏" %}</h5>
                        </div>
                    </div>
                </a>
            </div>

            <div class="col">
                <a href="{% url 'shopping' %}" class="text-decoration-none">
                    <div class="card text-center shadow-sm h-100">
                        <div class="card-body">
                            <h5 class="card-title">üõçÔ∏è {% trans "–ü–∞–∑–∞—Ä—É–≤–∞–Ω–µ/–†–∞–∑—Ö–æ–¥–∏" %}</h5>
                        </div>
                    </div>
                </a>
            </div>

            <div class="col">
                <a href="{% url 'income_home' %}" class="text-decoration-none">
                    <div class="card text-center shadow-sm h-100">
                        <div class="card-body">
                            <h5 class="card-title">üí∂ {% trans "–ü—Ä–∏—Ö–æ–¥–∏" %}</h5>
                        </div>
                    </div>
                </a>
            </div>

            <div class="col">
                <a href="{% url 'inventory' %}" class="text-decoration-none">
                    <div class="card text-center shadow-sm h-100">
                        <div class="card-body">
                            <h5 class="card-title">üè¨ {% trans "–ù–∞–ª–∏—á–Ω–æ—Å—Ç–∏" %}</h5>
                        </div>
                    </div>
                </a>
            </div>

            <div class="col">
                {% if user.is_authenticated %}
                    <a href="{% url 'cooking_home' %}" class="text-decoration-none">
                {% else %}
                    <a href="{% url 'recipe_list' %}" class="text-decoration-none">
                {% endif %}
                        <div class="card text-center shadow-sm h-100">
                            <div class="card-body">
                                <h5 class="card-title">ü•£ {% trans "–°–≥–æ—Ç–≤–∏" %}</h5>
                            </div>
                        </div>
                    </a>
            </div>

            <div class="col">
                <a href="{% url 'finance_home' %}" class="text-decoration-none">
                    <div class="card text-center shadow-sm h-100">
                        <div class="card-body">
                            <h5 class="card-title">üí∞ {% trans "–ü–∞—Ä–∏" %}</h5>
                        </div>
                    </div>
                </a>
            </div>

            <div class="col">
                <a href="{% url 'entertainment_home' %}" class="text-decoration-none">
                    <div class="card text-center shadow-sm h-100">
                        <div class="card-body">
                            <h5 class="card-title">üèùÔ∏èüçπ‚õ±Ô∏èüåû üåä {% trans "–ó–∞–±–∞–≤–ª–µ–Ω–∏–µ" %}</h5>
                        </div>
                    </div>
                </a>
            </div>

            <div class="col">
                <a href="{% url 'forum_home' %}" class="text-decoration-none">
                    <div class="card text-center shadow-sm h-100">
                        <div class="card-body">
                            <h5 class="card-title">üó™ {% trans "–§–æ—Ä—É–º" %}</h5>
                        </div>
                    </div>
                </a>
            </div>

            <div class="col">
                <a href="{% url 'task_list' %}" class="text-decoration-none">
                    <div class="card text-center shadow-sm h-100">
                        <div class="card-body">
                            <h5 class="card-title">üìù {% trans "–ó–∞–¥–∞—á–∏" %}</h5>
                        </div>
                    </div>
                </a>
            </div>

            <div class="col">
                <a href="{% url 'calendar' %}" class="text-decoration-none">
                    <div class="card text-center shadow-sm h-100">
                        <div class="card-body">
                            <h5 class="card-title">üóìÔ∏è {% trans "–ö–∞–ª–µ–Ω–¥–∞—Ä" %}</h5>
                        </div>
                    </div>
                </a>
            </div>

        </div>
    </div>

{% endblock %}
