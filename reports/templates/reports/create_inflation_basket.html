{% extends 'reports/reports_home.html' %}

{% block report_body %}

        <h3>–°—ä–∑–¥–∞–π –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—Å–∫–∞ –∫–æ—à–Ω–∏—Ü–∞</h3>
<form method="POST" action="{% url 'save_inflation_basket' %}">
    {% csrf_token %}
    <div class="mb-2">
        <input type="text" name="name" placeholder="–ò–º–µ –Ω–∞ –∫–æ—à–Ω–∏—Ü–∞—Ç–∞" class="form-control" required>
    </div>
    <h4 class="mt-4 mb-3">üß∫ –ü—Ä–æ–¥—É–∫—Ç–∏ –≤ –∫–æ—à–Ω–∏—Ü–∞—Ç–∞</h4>
<div class="table-responsive">
  <table class="table table-bordered align-middle" id="basketTable">
    <thead class="table-light">
      <tr>
        <th>–ü—Ä–æ–¥—É–∫—Ç</th>
        <th>–ü—Ä–µ–º–∞—Ö–Ω–∏</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>
          <select name="product_id[]" class="form-select">
            <option value="" disabled selected>–ò–∑–±–µ—Ä–∏ –ø—Ä–æ–¥—É–∫—Ç</option>
            {% for product in products %}
              <option value="{{ product.id }}">{{ product.product.name }}</option>
            {% endfor %}
          </select>
        </td>
        <td>
          <button type="button" class="removeRow btn btn-sm btn-danger">‚úñ</button>
        </td>
      </tr>
    </tbody>
  </table>
</div>
<button type="button" class="btn btn-primary mt-2" onclick="addRow()">‚ûï –î–æ–±–∞–≤–∏ –ø—Ä–æ–¥—É–∫—Ç</button>

    <button type="submit" class="btn btn-success">–°—ä–∑–¥–∞–π</button>
</form>
<script>
  function addRow() {
    const tableBody = document.querySelector('#basketTable tbody');
    const newRow = tableBody.rows[0].cloneNode(true);
    newRow.querySelector('select').selectedIndex = 0;
    tableBody.appendChild(newRow);
  }

  document.addEventListener("click", function(e) {
    if (e.target && e.target.classList.contains("removeRow")) {
      const row = e.target.closest("tr");
      const tableBody = document.querySelector('#basketTable tbody');
      if (tableBody.rows.length > 1) {
        row.remove();
      }
    }
  });
</script>

{% endblock %}